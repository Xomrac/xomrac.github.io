const translations = {
    it: {
        nav: {
            home: "Home",
            about: "About",
            projects: "Progetti",
            experience: "Esperienza",
            education: "Formazione", 
            skills: "Skills",
            contact: "Contatti"
        },
        hero: {
            title: "Benvenut…ô!",
            description: `<span class="keyword">Game developer</span> specializzato in <span class="keyword">Unity</span> e <span class="keyword">C#</span> con passione per la creazione
                        di <span class="keyword">esperienze interattive</span> coinvolgenti. Dal <span class="keyword">VR educativo</span> ai <span class="keyword">giochi mobile</span>, 
                        mi concentro su <span class="keyword">soluzioni innovative</span> che uniscono <span class="keyword">tecnologia</span> e <span class="keyword">creativit√†</span>.`
        },
        stats: {
            experience: "Anni di esperienza",
            projects: "Progetti completati", 
            enthusiasm: "Coding Enthusiast"
        },
        buttons: {
            projects: "Progetti",
            contact: "Contattami"
        },
        sections: {
            aboutTitle: "About Me",
            projectsTitle: "I miei progetti",
            projectsSubtitle: "Una collezione dei lavori che meglio rappresentano il mio percorso di sviluppo",
            experienceTitle: "Esperienza Lavorativa",
            experienceSubtitle: "Le tappe professionali che hanno formato le mie competenze",
            educationTitle: "Formazione",
            educationSubtitle: "Il mio percorso di crescita professionale e accademica",
            skillsTitle: "Competenze Tecniche",
            skillsSubtitle: "Gli strumenti e le tecnologie che padroneggio",
            contactTitle: "Collaboriamo insieme",
            contactSubtitle: "Hai un progetto in mente? Parliamone!"
        },
        about: {
            description: `<span class="keyword">Game developer fiorentino</span> con una forte passione per il <span class="keyword">problem-solving</span> e l'<span class="keyword">innovazione tecnologica</span>. 
                    Lavoro sia in <span class="keyword">team</span> che come <span class="keyword">freelancer</span>, specializzandomi nello sviluppo di giochi e applicazioni 
                    che combinano <span class="keyword">creativit√†</span> e <span class="keyword">funzionalit√†</span>. 
                    <br><br>
                    Negli ultimi tempi ho scoperto una crescente passione anche per la <span class="keyword">programmazione software tradizionale</span>, 
                    pur rimanendo principalmente focalizzato sul <span class="keyword">game development</span>. 
                    <br><br>
                    Dalle <span class="keyword">game jam</span> ai progetti pi√π seri, 
                    ogni sfida √® un'opportunit√† per perfezionare le mie <span class="keyword">competenze tecniche</span> e <span class="keyword">creative</span>. 
                    Mi dedico costantemente all'<span class="keyword">apprendimento di nuove tecnologie</span> e all'<span class="keyword">ottimizzazione dei processi</span> di sviluppo.
                    <br><br>
                    Nel tempo libero mi piace impegnarmi in attivit√† che stimolano la mente, come
                    <span class="keyword">board game complessi</span>, <span class="keyword">studiare nuovi linguaggi di programmazione</span> e sperimentare con <span class="keyword">progetti personali</span> in compagnia dei miei <span class="keyword">gatti</span>, 
                    che spesso si rivelano i migliori critici del mio codice.`
        },
        experience: {
            thesign: {
                title: "Assistente Didattico",
                location: "Firenze, Italia",
                description: "Assistenza tecnica e didattica principalmente agli studenti del secondo e terzo anno del corso di game programming, ma fornisco supporto tecnico e morale a tutti i team e studenti dei corsi di game dev. Mi occupo di essere disponibile per consigli, secondi pareri e risoluzione di problemi tecnici, fungendo da punto di riferimento accessibile ma non come docente di ruolo.",
                achievements: {
                    0: "Supporto tecnico e didattico agli studenti"
                }
            },
            whitesock: {
                title: "Unity Developer",
                location: "Firenze, Italia",
                description: "Main programmer su progetti VR/AR B2B nel settore della formazione, progetti B2C nel settore del mobile gaming per bambini e sviluppo di tool e framwork interni per ottimizzare i processi di sviluppo.",
                achievements: {
                    0: "Sviluppo ed ottimizzazione di esperienze VR immersive su meta quest 2/3/3s",
                    1: "Sviluppo di tool interni per il team di sviluppo",
                    2: "Sviluppo del gioco mobile \"viriv√¨ e l'ombra della pioggia\". Finalista \"Best In Impact\" ai IVGA 2025"
                }
            }
        },
        education: {
            firenze42: {
                title: "42 Common Core",
                location: "Firenze, Italia",
                description: `Percorso intensivo e pratico di programmazione imperativa, 
                        basato su progetti individuali e di gruppo in C, shell scripting, algoritmi e gestione della memoria. 
                        Ho sviluppato competenze in problem solving, debugging e collaborazione peer-to-peer, senza lezioni frontali n√© insegnanti, 
                        in un ambiente basato sull'apprendimento autonomo e sul confronto tra pari.`,
                achievements: {
                    0: "Problem solving avanzato",
                    1: "Gestione della memoria", 
                    2: "Debugging efficace"
                }
            },
            thesign: {
                title: "Diploma Game Programming",
                location: "Firenze, Italia",
                description: "Sviluppo di progetti in Unity e UE4 sia individualmente sia in team con altri studenti dei corsi di: 3D art, 2D art e game design.",
                achievements: {
                    0: "Acquisizione di solide basi in programmazione e logica",
                    1: "Apprendimento di come lavorare in un team multidisciplinare", 
                    2: "Approfondimento di programming patterns e architettura software"
                }
            }
        },
        categories: {
            all: "Tutti",
            work: "Lavorativi",
            gamejam: "Global Game Jam", 
            personal: "Personali",
            education: "Scolastici"
        },
        categoryTitles: {
            work: "Progetti Lavorativi",
            gamejam: "Global Game Jam",
            personal: "Progetti Personali", 
            education: "Progetti Scolastici"
        },
        skills: {
            title: "Competenze Tecniche",
            subtitle: "Gli strumenti e le tecnologie che padroneggio",
            categories: {
                gamedev: "Game Dev",
                programming: "Programming",
                tools: "Tools",
                platforms: "Platforms"
            }
        },
        contact: {
            title: "Collaboriamo insieme",
            subtitle: "Hai un progetto in mente? Parliamone!",
            email: "Email",
            linkedin: "LinkedIn"
        },
        futurePosition: {
            title: "Futura Posizione",
            subtitle: "In cerca di nuove opportunit√†",
            description: "Sempre aperto a nuove sfide e opportunit√† di crescita professionale."
        },
        projects: {
            notAvailable: "Non ancora disponibile",
            features: "Caratteristiche principali",
            technologies: "Tecnologie utilizzate",
            platforms: "Piattaforme",
            availableOn: "Disponibile su"
        }
    },
    en: {
        nav: {
            home: "Home",
            about: "About", 
            projects: "Projects",
            experience: "Experience",
            education: "Education",
            skills: "Skills", 
            contact: "Contact"
        },
        hero: {
            title: "Welcome!",
            description: `<span class="keyword">Game developer</span> specialized in <span class="keyword">Unity</span> and <span class="keyword">C#</span> with a passion for creating
                        engaging <span class="keyword">interactive experiences</span>. From <span class="keyword">educational VR</span> to <span class="keyword">mobile games</span>, 
                        I focus on <span class="keyword">innovative solutions</span> that combine <span class="keyword">technology</span> and <span class="keyword">creativity</span>.`
        },
        stats: {
            experience: "Years of experience",
            projects: "Completed projects",
            enthusiasm: "Coding Enthusiast"
        },
        buttons: {
            projects: "Projects",
            contact: "Contact Me"
        },
        sections: {
            aboutTitle: "About Me", 
            projectsTitle: "My Projects",
            projectsSubtitle: "A collection of works that best represent my development journey",
            experienceTitle: "Work Experience", 
            experienceSubtitle: "The professional milestones that shaped my skills",
            educationTitle: "Education",
            educationSubtitle: "My journey of professional and academic growth", 
            skillsTitle: "Technical Skills",
            skillsSubtitle: "The tools and technologies I master",
            contactTitle: "Let's Work Together",
            contactSubtitle: "Have a project in mind? Let's talk about it!"
        },
        about: {
            description: `<span class="keyword">Italian game developer</span> with a strong passion for <span class="keyword">problem-solving</span> and <span class="keyword">technological innovation</span>. 
                    I work both in <span class="keyword">teams</span> and as a <span class="keyword">freelancer</span>, specializing in developing games and applications 
                    that combine <span class="keyword">creativity</span> and <span class="keyword">functionality</span>. 
                    <br><br>
                    Recently, I've discovered a growing passion for <span class="keyword">traditional software programming</span> as well, 
                    while remaining primarily focused on <span class="keyword">game development</span>. 
                    <br><br>
                    From <span class="keyword">game jams</span> to more serious projects, 
                    every challenge is an opportunity to refine my <span class="keyword">technical</span> and <span class="keyword">creative skills</span>. 
                    I constantly dedicate myself to <span class="keyword">learning new technologies</span> and <span class="keyword">optimizing development processes</span>.
                    <br><br>
                    In my free time, I enjoy engaging in activities that stimulate the mind, such as
                    <span class="keyword">complex board games</span>, <span class="keyword">studying new programming languages</span>, and experimenting with <span class="keyword">personal projects</span> in the company of my <span class="keyword">cats</span>, 
                    who often prove to be the best critics of my code.`
        },
        experience: {
            thesign: {
                title: "Teaching Assistant",
                location: "Florence, Italy",
                description: "Technical and educational assistance mainly to second and third year students of the game programming course, but I provide technical and moral support to all teams and students of the game dev courses. I take care of being available for advice, second opinions and technical problem solving, serving as an accessible reference point but not as a full-time teacher.",
                achievements: {
                    0: "Technical and educational support for students"
                }
            },
            whitesock: {
                title: "Unity Developer",
                location: "Florence, Italy",
                description: "Main programmer on VR/AR B2B projects in the training sector, B2C projects in the mobile gaming sector for children and development of internal tools and frameworks to optimize development processes.",
                achievements: {
                    0: "Development and optimization of immersive VR experiences on Meta Quest 2/3/3s",
                    1: "Development of internal tools for the development team",
                    2: "Development of the mobile game 'viriv√¨ e l'ombra della pioggia'. Finalist 'Best In Impact' at IVGA 2025"
                }
            }
        },
        education: {
            firenze42: {
                title: "42 Common Core",
                location: "Florence, Italy",
                description: `Intensive and practical imperative programming path, 
                        based on individual and group projects in C, shell scripting, algorithms and memory management. 
                        I developed skills in problem solving, debugging and peer-to-peer collaboration, without lectures or teachers, 
                        in an environment based on autonomous learning and peer comparison.`,
                achievements: {
                    0: "Advanced problem solving",
                    1: "Memory management", 
                    2: "Effective debugging"
                }
            },
            thesign: {
                title: "Game Programming Diploma",
                location: "Florence, Italy",
                description: "Development of projects in Unity and UE4 both individually and in teams with other students from courses in: 3D art, 2D art and game design.",
                achievements: {
                    0: "Acquisition of solid foundations in programming and logic",
                    1: "Learning how to work in a multidisciplinary team", 
                    2: "In-depth study of programming patterns and software architecture"
                }
            }
        },
        categories: {
            all: "All",
            work: "Work",
            gamejam: "Global Game Jam", 
            personal: "Personal",
            education: "School"
        },
        categoryTitles: {
            work: "Work Projects",
            gamejam: "Global Game Jam",
            personal: "Personal Projects", 
            education: "School Projects"
        },
        skills: {
            title: "Technical Skills",
            subtitle: "The tools and technologies I master",
            categories: {
                gamedev: "Game Dev",
                programming: "Programming",
                tools: "Tools",
                platforms: "Platforms"
            }
        },
        contact: {
            title: "Let's Work Together",
            subtitle: "Have a project in mind? Let's talk about it!",
            email: "Email",
            linkedin: "LinkedIn"
        },
        futurePosition: {
            title: "Future Position",
            subtitle: "Looking for new opportunities",
            description: "Always open to new challenges and professional growth opportunities."
        },
        projects: {
            notAvailable: "Not yet available",
            features: "Key Features",
            technologies: "Technologies Used",
            platforms: "Platforms",
            availableOn: "Available on"
        }
    }
};

let currentLanguage = 'it';

function setLanguage(lang) {
    currentLanguage = lang;
    localStorage.setItem('preferredLanguage', lang);
    updateContent();
    updateLanguageButton();
    
    // Reload projects data for the new language
    if (typeof window.reloadProjectsData === 'function') {
        window.reloadProjectsData(lang);
    } else {
        console.log('Project reload function not available yet');
    }
}

function updateContent() {
    const elements = document.querySelectorAll('[data-translate]');
    elements.forEach(element => {
        const key = element.getAttribute('data-translate');
        const translation = getNestedTranslation(translations[currentLanguage], key);
        if (translation) {
            element.innerHTML = translation;
        }
    });
}

function getNestedTranslation(obj, path) {
    return path.split('.').reduce((o, p) => o && o[p], obj);
}

function updateLanguageButton() {
    const button = document.getElementById('languageToggle');
    const flagIcon = button.querySelector('.flag-icon');
    const langText = button.querySelector('.lang-text');
    
    if (currentLanguage === 'it') {
        flagIcon.textContent = 'üáÆüáπ';
        langText.textContent = 'IT';
    } else {
        flagIcon.textContent = 'üá¨üáß';
        langText.textContent = 'EN';
    }
}

function toggleLanguage() {
    const newLang = currentLanguage === 'it' ? 'en' : 'it';
    setLanguage(newLang);
}

// Function to detect browser language
function detectBrowserLanguage() {
    // Get browser language
    const browserLang = navigator.language || navigator.userLanguage || navigator.systemLanguage;
    
    // Check if browser is set to Italian
    if (browserLang.toLowerCase().startsWith('it')) {
        return 'it';
    }
    
    // Default to English for all other languages
    return 'en';
}

// Initialize language system
document.addEventListener('DOMContentLoaded', function() {
    // Get preferred language from localStorage, or detect from browser, or default to Italian
    let preferredLanguage = localStorage.getItem('preferredLanguage');
    
    if (!preferredLanguage) {
        // First visit - detect browser language
        preferredLanguage = detectBrowserLanguage();
    }
    
    setLanguage(preferredLanguage);
    
    // Load initial projects data with retry mechanism
    const initializeProjectsWithRetry = () => {
        if (typeof window.initializeProjects === 'function') {
            window.initializeProjects(preferredLanguage);
        } else {
            console.log('Waiting for project system to load...');
            setTimeout(initializeProjectsWithRetry, 100);
        }
    };
    
    initializeProjectsWithRetry();
    
    // Add event listener to language toggle button
    const languageToggle = document.getElementById('languageToggle');
    if (languageToggle) {
        languageToggle.addEventListener('click', toggleLanguage);
    }
});